
<div class="row">

<div class="medium-9 push-3 columns">

<% if @matches.blank? %>
	<div class="row">
		<div class="small-10 small-centered columns previewtile text-center">
			<% if action_name == "index" %>
				<h2>No Distributors</h2> <br>Please try altering your filter selections.
			<% elsif action_name == "index_saved_matches" %>
				<h2>No Saved Distributors</h2> <br>You can save distributor matches on the <%= link_to 'All Distributors', all_matches_url %> screen.
			<% elsif action_name == "index_contacted_matches" %>
				<h2>You haven't contacted any distributors</h2> <br>You can contact distributors on the <br><%= link_to 'All Distributors', all_matches_url %> or <%= link_to 'Saved Distributors', saved_matches_url %> screens.
			<% elsif action_name == "index_incoming_matches" %>
				<h2>No distributors have contacted you</h2><br>Make sure <%= link_to 'Your Profile', brand_full_profile_url %>  is complete.
			<% end %>
		</div>
	</div>
<% else %>

	<div class="row">
		<div class="small-12 columns">

			<table>
				  <thead>
				  	<tr><th width="800" colspan="2">
				  		<%= render "counts" %>
				  	</th></tr>
				  	<tr>
				  		<th>
								Company
					  	</th>
				  		<th>
								Countries of Distribution
					  	</th>
					  </tr>				  	
				  </thead>
			  	<tbody>
					<% @matches.sort_by {|x| [x.country_of_origin, x.company_name] }.each do |match| %>
					<tr>
						<td>

							<div class="row">
								<div class="medium-3 columns">
									<img src="images/Default_Logo.svg" width="200" height="200">
								</div>
								<div class="medium-9 columns">
									<h2><%= link_to match.company_name, view_match_url(match.id, action_name) %></h2>
								</div>
							</div>
							<div class="row">
								<div class="medium-12 columns">
									<%= render partial: "match_list_indicators", locals: {match: match} %>


									<% if match.user.last_login %>
										Active in the past <%= last_activity(match.user.last_login) %>
									<% end %>


									<% has_unread, count = unread_count_from_match(match) %>
									<% if has_unread %>
									<br>You have <%= count %> unread messages
									<% end %>
								</div>
							</div>
						
						</td>
						<td>

							<% match.export_countries.sort_by{ |m| m.country.downcase }.each do |ec| %>
								<%= ec.country %> <%= ec.country == match.country_of_origin ? "<small>(Headquarters)</small>".html_safe : "" %><br>
							<% end %>

						</td>
					</tr>
					<% end %>
					</tbody>
		</table>
		</div>
	</div>
<% end %>



</div> <!-- /.medium-9 push-3 columns-->

<div class="medium-3 pull-9 columns <%= action_name == "index" ? "previewtile" : "" %>">

<% if action_name == "index" %>
<div class="profile-outer-tile">
	<h3><strong> Filters </strong></h3>
	<%= form_tag all_matches_url, method: 'post' do %>
	<div class="row filterform">
		<div class="small-12 columns">
			<strong><small>Headquarters</small></strong>
			<% @countries.each_with_index do |co, index| %>
				<%= render partial: "shared/filter_checkbox", locals: {field: "country", label: co, fid: co, cbid: "country_#{index}", on_off_switch: filter_on_or_off(co, @country), cclass: "mfcountry filterform" } %>
			<% end %>
			<input id="selectallcountries" name="selectallcountries" type="checkbox" style="font-color: black;" class="filter" checked/>
			<label for="selectallcountries" style="color: black; border: 1px dotted black; background: transparent;">Select/Deselect All</label>			
			<hr>
		</div>
	</div>
	<div class="row filterform">
		<div class="small-12 columns">
			<strong><small>Countries of Distribution</small></strong>
			<% @countries_of_distribution.sort.each_with_index do |co, index| %>
				<%= render partial: "shared/filter_checkbox", locals: {field: "country_of_distribution", label: co, fid: co, cbid: "countryofdistro_#{index}", on_off_switch: filter_on_or_off(co, @country_of_distribution), cclass: "mfcountryofdistro" } %>
			<% end %>
			<input id="selectallcountriesofdistro" name="selectallcountriesofdistro" type="checkbox" style="font-color: black;" class="filter" checked/>
			<label for="selectallcountriesofdistro" style="color: black; border: 1px dotted black; background: transparent;">Select/Deselect All</label>
			<hr>
		</div>		
	</div>
	<div class="row filterform">
		<div class="small-12 columns">
			<strong><small>Company Size</small></strong>
			<% CompanySize.all.each_with_index do |co, index| %>
				<%= render partial: "shared/filter_checkbox", locals: {field: "size", label: co.name, fid: co.id, cbid: "size_#{index}", on_off_switch: filter_on_or_off(co.id.to_s, @size), cclass: "mfsize" } %>
			<% end %>
			<input id="selectallsizes" name="selectallsizes" type="checkbox" style="font-color: black;" class="filter" checked/>
			<label for="selectallsizes" style="color: black; border: 1px dotted black; background: transparent;">Select/Deselect All</label>
			<hr>
		</div>
	</div>
	<div class="row filterform">
		<div class="small-12 columns">
			<strong><small>Channels</small></strong>
			<% @profile.channels.each_with_index do |co, index| %>
				<%= render partial: "shared/filter_checkbox", locals: {field: "channel", label: co.name, fid: co.id, cbid: "channel_#{index}", on_off_switch: filter_on_or_off(co.id.to_s, @channel), cclass: "mfchannel" } %>
			<% end %>
			<input id="selectallchannels" name="selectallchannels" type="checkbox" style="font-color: black;" class="filter" checked/>
			<label for="selectallchannels" style="color: black; border: 1px dotted black; background: transparent;">Select/Deselect All</label>
			<hr>
		</div>
	</div>

	<div class="row">
		<div class="small-12 columns">
			<%= submit_tag 'Filter Results', class: "tiny radius success button right" %>
		</div>
	</div>
	<% end %>
</div>
<% end %>

</div> <!-- /.medium-3 pull-9 columns-->

</div> <!-- /.row -->
